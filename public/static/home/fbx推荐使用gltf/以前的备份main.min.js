//坐标数组
var Zuobiao = {
	0: {
		x: 1700,
		y: 67,
		z: -169
	},
	1: {
		x: -332.212361341873,
		y: 135,
		z: -372.2771663110949
	},
	2: {
		x: 1451.1002222539519,
		y: 119.79292635756684,
		z: -394.49240861008286
	},
	3: {
		x: 1526.7727366859954,
		y: 67.94768296196075,
		z: -139.35377202773034
	},
	4: {
		x: 1362.7497321568467,
		y: 200,
		z: -490.0567875740754
	},
	5: {
		x: 1986.1734994194667,
		y: 127.27009328988737,
		z: -410.5904461485301
	},
	6: {
		x: -1724.4479349222675,
		y: 151.18827122722846,
		z: -401.3375368393308
	},
	7: {
		x: -525.5665915768031,
		y: 178.8424539422433,
		z: -418.00338970664694
	},
	8: {
		x: 1564.4235638796436,
		y: 95.25531747551074,
		z: -304.0065051774942
	},
	9: {
		x: -93.4566291934675,
		y: 197.28672786660428,
		z: -576.7395268936846
	}
};
var fbx = new THREE.Object3D();
var fog = new THREE.Fog(0xe5f7ff, 5000, 10000);
var scene = new THREE.Scene();
scene.fog = fog;
var geometry = new THREE.PlaneGeometry(100000, 100000);
var material = new THREE.MeshLambertMaterial({
	color: 0xdaff9b,
	side: THREE.DoubleSide
});
var mesh = new THREE.Mesh(geometry, material);
mesh.position.set(0, -50, 0);
mesh.rotateX(Math.PI / 2);
scene.add(mesh);
var camera = new THREE.PerspectiveCamera(45, window.innerWidth / window.innerHeight, 1, 50000);
camera.lookAt(new THREE.Vector3(-377.6905913215717, 1.2573549810357995e-13, -457.7376575934736));
camera.position.set(-2000, 1800, 1800);
var xishu = 0.20;

function make(scale, posi, color, imgADD) {
	var geometry = new THREE.BoxGeometry(scale.x, scale.y, scale.z);
	var material = new THREE.MeshLambertMaterial({
		color: color,
		side: THREE.DoubleSide
	});
	var mesh = new THREE.Mesh(geometry, material);
	mesh.position.set(posi.x, posi.y, posi.z);
	var texture = new THREE.TextureLoader().load(imgADD);
	var spriteMaterial = new THREE.SpriteMaterial({
		map: texture,
	});
	var sprite = new THREE.Sprite(spriteMaterial);
	sprite.position.set(posi.x, posi.y + 45, posi.z);
	var s = sprite.position.distanceTo(camera.position);
	sprite.scale.set(s * xishu, s * xishu / 5, 1);
	scene.add(sprite);
	return sprite
}

function getColor() {
	var colorValue = "0,1,2,3,4,5,6,7,8,9,a,b,c,d,e,f";
	var colorArray = colorValue.split(",");
	var color = "#";
	for (var i = 0; i < 6; i += 1) {
		color += colorArray[Math.floor(Math.random() * 16)]
	}
	return color
}

function RandomNumBoth(Min, Max) {
	var Range = Max - Min;
	var Rand = Math.random();
	var num = Min + Math.round(Rand * Range);
	return num
}
var sArry = [];
sArry.push(make({
	x: 0,
	y: 0,
	z: 0
}, {
	x: 1700,
	y: 67,
	z: -169
}, getColor(), 'static/img/hycq.png'), make({
	x: 0,
	y: 0,
	z: 0
}, {
	x: -332.212361341873,
	y: 135,
	z: -372.2771663110949
}, getColor(), 'static/img/fxy.png'), make({
	x: 0,
	y: 0,
	z: 0
}, {
	x: 1451.1002222539519,
	y: 119.79292635756684,
	z: -394.49240861008286
}, getColor(), 'static/img/lytt.png'), make({
	x: 0,
	y: 0,
	z: 0
}, {
	x: 1526.7727366859954,
	y: 67.94768296196075,
	z: -139.35377202773034
}, getColor(), 'static/img/zjs.png'), make({
	x: 0,
	y: 0,
	z: 0
}, {
	x: 1362.7497321568467,
	y: 200,
	z: -490.0567875740754
}, getColor(), 'static/img/djl.png'), make({
	x: 0,
	y: 0,
	z: 0
}, {
	x: 1986.1734994194667,
	y: 127.27009328988737,
	z: -410.5904461485301
}, getColor(), 'static/img/xjp.png'), make({
	x: 0,
	y: 0,
	z: 0
}, {
	x: -1724.4479349222675,
	y: 151.18827122722846,
	z: -401.3375368393308
}, getColor(), 'static/img/dhyc.png'), make({
	x: 0,
	y: 0,
	z: 0
}, {
	x: -525.5665915768031,
	y: 178.8424539422433,
	z: -418.00338970664694
}, getColor(), 'static/img/wyty.png'), make({
	x: 0,
	y: 0,
	z: 0
}, {
	x: 1564.4235638796436,
	y: 95.25531747551074,
	z: -304.0065051774942
}, getColor(), 'static/img/wyzl.png'), make({
	x: 0,
	y: 0,
	z: 0
}, {
	x: -93.4566291934675,
	y: 197.28672786660428,
	z: -576.7395268936846
}, getColor(), 'static/img/hjs.png'), make({
	x: 0,
	y: 0,
	z: 0
}, {
	x: -2.1809031320904424,
	y: 20,
	z: 183.40624591076005
}, getColor(), 'static/img/dangqianweizhi.png'), make({
	x: 0,
	y: 0,
	z: 0
}, {
	x: -763.6114405580065,
	y: 150,
	z: -313.0880354264349
}, getColor(), 'static/img/wyzl.png'));
var loader = new THREE.FBXLoader();
loader.load('static/fbx/mountain.FBX', function(fbx) {
	fbx.position.set(0, 10, 0);
	this.fbx = fbx;
	scene.add(fbx)
});
var point = new THREE.PointLight(0xffffff);
point.position.set(0, 1500, 0);
scene.add(point);
var ambient = new THREE.AmbientLight(0xffffff);
scene.add(ambient);
var renderer = new THREE.WebGLRenderer();
renderer.setSize(window.innerWidth * 3, window.innerHeight * 3);
renderer.setClearColor(0xe5f7ff, 1);
renderer.domElement.style.width = window.innerWidth + 'px';
renderer.domElement.style.height = window.innerHeight + 'px';
document.body.appendChild(renderer.domElement);
var arr1res = JSON.parse(
	'[{"pos":{"x":-758.791167802309,"y":13.531916558318247,"z":191.45137879774654},"i":"23","j":"2"},{"pos":{"x":-413.2318596429638,"y":24.64124499280024,"z":203.54990766875298},"i":"23","j":"3"},{"pos":{"x":-8.953175113713087,"y":24.64124633973416,"z":176.73630058960433},"i":"23","j":"4"},{"pos":{"x":250.1373972739441,"y":24.641247262610715,"z":160.7271477348982},"i":"23","j":"5"},{"pos":{"x":494.66318762302853,"y":24.64125011310945,"z":141.54698183256195},"i":"23","j":"6"},{"pos":{"x":651.688003385274,"y":32.115764938981584,"z":82.71897131788498},"i":"23","j":"7"},{"pos":{"x":836.4076878840283,"y":32.11576277867019,"z":59.86891958969119},"i":"23","j":"8"},{"pos":{"x":994.9649386461929,"y":32.11576790650638,"z":24.531244378692975},"i":"23","j":"9"},{"pos":{"x":1072.5011651993482,"y":32.11577159014091,"z":12.911349575014526},"i":"23","j":"10"},{"pos":{"x":1290.4111678415607,"y":32.338820728291054,"z":11.585963743438526},"i":"23","j":"11"},{"pos":{"x":1530.907550516189,"y":42.893409729003956,"z":-16.11970677227032},"i":"23","j":"12"},{"pos":{"x":-17.0818526348653,"y":31.19140625000003,"z":83.45960951802829},"i":"22","j":"4"},{"pos":{"x":-317.4163208266366,"y":57.51581840616975,"z":121.92390797432368},"i":"21","j":"4"},{"pos":{"x":-387.49950321336763,"y":58.56521327310569,"z":55.29454369528776},"i":"20","j":"4"},{"pos":{"x":-659.2859421659585,"y":67.76026476921064,"z":44.82117238314379},"i":"19","j":"4"},{"pos":{"x":-423.1888683809601,"y":81.68630627554018,"z":-70.08522118487667},"i":"18","j":"4"},{"pos":{"x":-683.358019321117,"y":89.21209716796882,"z":-83.43591809387908},"i":"17","j":"4"},{"pos":{"x":-452.15363413851253,"y":103.22413103023025,"z":-131.62416724972212},"i":"16","j":"4"},{"pos":{"x":-705.4076958803497,"y":116.19096374511685,"z":-278.8795511681748},"i":"15","j":"4"},{"pos":{"x":-1112.3150095671551,"y":116.19095700064656,"z":-322.32780566700876},"i":"15","j":"3"},{"pos":{"x":-1495.5593382281133,"y":129.10465864662103,"z":-378.7587188819591},"i":"15","j":"2"},{"pos":{"x":-1866.7922336480071,"y":146.72808187745719,"z":-402.89606401050287},"i":"15","j":"1"},{"pos":{"x":-1704.8008816471404,"y":148.6920268679775,"z":-435.408283834985},"i":"14","j":"1"},{"pos":{"x":-1582.8909577810027,"y":157.1783129451293,"z":-466.20464844330786},"i":"13","j":"1"},{"pos":{"x":-1414.7053598782027,"y":162.37966106528543,"z":-480.04287664648973},"i":"12","j":"1"},{"pos":{"x":-1312.7860456229623,"y":163.16601644708288,"z":-504.5385159683033},"i":"11","j":"1"},{"pos":{"x":-1263.0937058057216,"y":169.53206102394796,"z":-521.5904397237873},"i":"10","j":"1"},{"pos":{"x":-1506.2906063251016,"y":165.55592952720434,"z":-539.0817942795882},"i":"9","j":"1"},{"pos":{"x":-1940.3203112866695,"y":174.45061815910654,"z":-482.0112172439906},"i":"8","j":"1"},{"pos":{"x":-1984.5330509033079,"y":178.54321289062517,"z":-574.9771493611277},"i":"7","j":"1"},{"pos":{"x":-1635.4594047066753,"y":180.94646435405113,"z":-629.9299444308456},"i":"6","j":"1"},{"pos":{"x":-495.50377922850413,"y":116.19095397067315,"z":-309.39771132783335},"i":"15","j":"5"},{"pos":{"x":-163.10147231199153,"y":116.19096007197516,"z":-330.0413344436704},"i":"15","j":"6"},{"pos":{"x":184.959796485178,"y":116.19095632422034,"z":-325.79117549780585},"i":"15","j":"7"},{"pos":{"x":374.25425349730904,"y":116.19095911356192,"z":-325.17015533133053},"i":"15","j":"8"},{"pos":{"x":685.3378133554488,"y":116.19095703349434,"z":-380.272429030553},"i":"15","j":"9"},{"pos":{"x":1121.1176357251434,"y":116.19096100242739,"z":-473.2064546201332},"i":"15","j":"10"},{"pos":{"x":1441.32248326627,"y":116.19095611572234,"z":-437.4352946752126},"i":"15","j":"11"},{"pos":{"x":1894.6799201306126,"y":128.60245100574244,"z":-455.1580467096578},"i":"15","j":"12"},{"pos":{"x":1914.2759131825314,"y":121.55249907468092,"z":-406.4202842796717},"i":"16","j":"12"},{"pos":{"x":1568.1588312586086,"y":79.04368105612785,"z":-240.81057386750848},"i":"17","j":"12"},{"pos":{"x":1606.6359439935213,"y":68.48014821191472,"z":-177.16816137298912},"i":"18","j":"12"},{"pos":{"x":1386.0236412242639,"y":59.968360900878984,"z":-141.97448811143926},"i":"19","j":"12"},{"pos":{"x":1379.6224011501095,"y":58.765798853727645,"z":-98.99137321099607},"i":"20","j":"12"},{"pos":{"x":1368.791583158415,"y":52.35340195908617,"z":-50.655307818473375},"i":"21","j":"12"},{"pos":{"x":1468.0913080124874,"y":47.339529359906976,"z":-41.674911305647925},"i":"22","j":"12"},{"pos":{"x":-451.8213536771252,"y":161.88983772975018,"z":-349.88763215313566},"i":"14","j":"4"},{"pos":{"x":-671.2107678789874,"y":151.28932044020723,"z":-361.98997130844486},"i":"13","j":"4"},{"pos":{"x":-428.18935420745436,"y":162.54741146217398,"z":-383.58832887377775},"i":"12","j":"4"},{"pos":{"x":-680.3461704294165,"y":178.71076196696882,"z":-414.9060703661339},"i":"11","j":"4"},{"pos":{"x":-888.504808819488,"y":188.33585456575216,"z":-469.0497244977571},"i":"10","j":"4"},{"pos":{"x":-1025.6233888421164,"y":185.6397135814324,"z":-482.54857337365},"i":"10","j":"3"},{"pos":{"x":-1182.241451934954,"y":177.3110737448016,"z":-531.8855803040276},"i":"10","j":"2"},{"pos":{"x":-810.5015146891137,"y":189.86479387640898,"z":-487.03128961385073},"i":"9","j":"4"},{"pos":{"x":-951.3349291744538,"y":197.72665352928033,"z":-507.28814598943313},"i":"8","j":"4"},{"pos":{"x":-886.9415094217788,"y":197.72662353515597,"z":-550.6450661830595},"i":"8","j":"7"},{"pos":{"x":-1040.230282015935,"y":210.50912712969347,"z":-600.8021041904242},"i":"6","j":"4"},{"pos":{"x":-900.1614482674755,"y":204.29255327269422,"z":-677.6125835318344},"i":"6","j":"5"},{"pos":{"x":-581.8523187467684,"y":200.9985978409256,"z":-690.2279792243389},"i":"6","j":"6"},{"pos":{"x":-298.6401688375413,"y":202.00957234678455,"z":-688.9907860189139},"i":"6","j":"7"},{"pos":{"x":-55.273264898306024,"y":203.4520443986182,"z":-665.6116410527218},"i":"6","j":"8"},{"pos":{"x":93.4817497720245,"y":204.14654775453275,"z":-658.6025096259746},"i":"6","j":"9"},{"pos":{"x":248.82236440006477,"y":203.77726310435511,"z":-677.1608636049148},"i":"6","j":"10"},{"pos":{"x":489.6944108558698,"y":203.22364163106587,"z":-692.3716578268422},"i":"6","j":"11"},{"pos":{"x":735.7877373950505,"y":204.74856505061845,"z":-631.1120186476071},"i":"6","j":"12"},{"pos":{"x":739.1749079136246,"y":207.26948889032673,"z":-533.4819345165006},"i":"7","j":"12"},{"pos":{"x":712.0840614931685,"y":207.26948731612052,"z":-474.7322829590298},"i":"8","j":"12"},{"pos":{"x":445.0934190813075,"y":207.26950073242205,"z":-565.5806142878043},"i":"9","j":"12"},{"pos":{"x":288.63724692704477,"y":197.72662353515642,"z":-543.6688469785256},"i":"10","j":"12"},{"pos":{"x":204.0296712278863,"y":197.72662980359308,"z":-543.9464180011455},"i":"10","j":"11"},{"pos":{"x":8.375508677197786,"y":197.72662665331535,"z":-553.5188343206944},"i":"10","j":"10"},{"pos":{"x":-109.55321221308486,"y":197.72662760107158,"z":-551.3247164248887},"i":"10","j":"9"},{"pos":{"x":-179.1411561810537,"y":197.72662874712086,"z":-523.8271417483049},"i":"10","j":"8"},{"pos":{"x":-368.78467551643416,"y":197.72665405273452,"z":-472.5985925694922},"i":"10","j":"7"},{"pos":{"x":-528.280416257525,"y":197.72665751960963,"z":-476.94543726925076},"i":"10","j":"6"},{"pos":{"x":-594.8213156427431,"y":197.72665611293556,"z":-492.94637586716044},"i":"10","j":"5"},{"pos":{"x":-795.2211457288549,"y":188.99926332992678,"z":-490.44334283782337},"i":"10","j":"4"},{"pos":{"x":-990.7939575366937,"y":207.61803529413527,"z":-583.7111715295669},"i":"7","j":"4"}]'
);
var arr2res = JSON.parse(
	'[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,{"x":-1635.4594047066753,"y":180.94646435405113,"z":-629.9299444308456},0,0,{"x":-1040.230282015935,"y":210.50912712969347,"z":-600.8021041904242},{"x":-900.1614482674755,"y":204.29255327269422,"z":-677.6125835318344},{"x":-581.8523187467684,"y":200.9985978409256,"z":-690.2279792243389},{"x":-298.6401688375413,"y":202.00957234678455,"z":-688.9907860189139},{"x":-55.273264898306024,"y":203.4520443986182,"z":-665.6116410527218},{"x":93.4817497720245,"y":204.14654775453275,"z":-658.6025096259746},{"x":248.82236440006477,"y":203.77726310435511,"z":-677.1608636049148},{"x":489.6944108558698,"y":203.22364163106587,"z":-692.3716578268422},{"x":735.7877373950505,"y":204.74856505061845,"z":-631.1120186476071},0,0,0,0,0,0,0,0,0],[0,{"x":-1984.5330509033079,"y":178.54321289062517,"z":-574.9771493611277},0,0,{"x":-990.7939575366937,"y":207.61803529413527,"z":-583.7111715295669},0,0,0,0,0,0,0,{"x":739.1749079136246,"y":207.26948889032673,"z":-533.4819345165006},0,0,0,0,0,0,0,0,0],[0,{"x":-1940.3203112866695,"y":174.45061815910654,"z":-482.0112172439906},0,0,{"x":-951.3349291744538,"y":197.72665352928033,"z":-507.28814598943313},0,0,{"x":-886.9415094217788,"y":197.72662353515597,"z":-550.6450661830595},0,0,0,0,{"x":712.0840614931685,"y":207.26948731612052,"z":-474.7322829590298},0,0,0,0,0,0,0,0,0],[0,{"x":-1506.2906063251016,"y":165.55592952720434,"z":-539.0817942795882},0,0,{"x":-810.5015146891137,"y":189.86479387640898,"z":-487.03128961385073},0,0,0,0,0,0,0,{"x":445.0934190813075,"y":207.26950073242205,"z":-565.5806142878043},0,0,0,0,0,0,0,0,0],[0,{"x":-1263.0937058057216,"y":169.53206102394796,"z":-521.5904397237873},{"x":-1182.241451934954,"y":177.3110737448016,"z":-531.8855803040276},{"x":-1025.6233888421164,"y":185.6397135814324,"z":-482.54857337365},{"x":-795.2211457288549,"y":188.99926332992678,"z":-490.44334283782337},{"x":-594.8213156427431,"y":197.72665611293556,"z":-492.94637586716044},{"x":-528.280416257525,"y":197.72665751960963,"z":-476.94543726925076},{"x":-368.78467551643416,"y":197.72665405273452,"z":-472.5985925694922},{"x":-179.1411561810537,"y":197.72662874712086,"z":-523.8271417483049},{"x":-109.55321221308486,"y":197.72662760107158,"z":-551.3247164248887},{"x":8.375508677197786,"y":197.72662665331535,"z":-553.5188343206944},{"x":204.0296712278863,"y":197.72662980359308,"z":-543.9464180011455},{"x":288.63724692704477,"y":197.72662353515642,"z":-543.6688469785256},0,0,0,0,0,0,0,0,0],[0,{"x":-1312.7860456229623,"y":163.16601644708288,"z":-504.5385159683033},0,0,{"x":-680.3461704294165,"y":178.71076196696882,"z":-414.9060703661339},0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,{"x":-1414.7053598782027,"y":162.37966106528543,"z":-480.04287664648973},0,0,{"x":-428.18935420745436,"y":162.54741146217398,"z":-383.58832887377775},0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,{"x":-1582.8909577810027,"y":157.1783129451293,"z":-466.20464844330786},0,0,{"x":-671.2107678789874,"y":151.28932044020723,"z":-361.98997130844486},0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,{"x":-1704.8008816471404,"y":148.6920268679775,"z":-435.408283834985},0,0,{"x":-451.8213536771252,"y":161.88983772975018,"z":-349.88763215313566},0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,{"x":-1866.7922336480071,"y":146.72808187745719,"z":-402.89606401050287},{"x":-1495.5593382281133,"y":129.10465864662103,"z":-378.7587188819591},{"x":-1112.3150095671551,"y":116.19095700064656,"z":-322.32780566700876},{"x":-705.4076958803497,"y":116.19096374511685,"z":-278.8795511681748},{"x":-495.50377922850413,"y":116.19095397067315,"z":-309.39771132783335},{"x":-163.10147231199153,"y":116.19096007197516,"z":-330.0413344436704},{"x":184.959796485178,"y":116.19095632422034,"z":-325.79117549780585},{"x":374.25425349730904,"y":116.19095911356192,"z":-325.17015533133053},{"x":685.3378133554488,"y":116.19095703349434,"z":-380.272429030553},{"x":1121.1176357251434,"y":116.19096100242739,"z":-473.2064546201332},{"x":1441.32248326627,"y":116.19095611572234,"z":-437.4352946752126},{"x":1894.6799201306126,"y":128.60245100574244,"z":-455.1580467096578},0,0,0,0,0,0,0,0,0],[0,0,0,0,{"x":-452.15363413851253,"y":103.22413103023025,"z":-131.62416724972212},0,0,0,0,0,0,0,{"x":1914.2759131825314,"y":121.55249907468092,"z":-406.4202842796717},0,0,0,0,0,0,0,0,0],[0,0,0,0,{"x":-683.358019321117,"y":89.21209716796882,"z":-83.43591809387908},0,0,0,0,0,0,0,{"x":1568.1588312586086,"y":79.04368105612785,"z":-240.81057386750848},0,0,0,0,0,0,0,0,0],[0,0,0,0,{"x":-423.1888683809601,"y":81.68630627554018,"z":-70.08522118487667},0,0,0,0,0,0,0,{"x":1606.6359439935213,"y":68.48014821191472,"z":-177.16816137298912},0,0,0,0,0,0,0,0,0],[0,0,0,0,{"x":-659.2859421659585,"y":67.76026476921064,"z":44.82117238314379},0,0,0,0,0,0,0,{"x":1386.0236412242639,"y":59.968360900878984,"z":-141.97448811143926},0,0,0,0,0,0,0,0,0],[0,0,0,0,{"x":-387.49950321336763,"y":58.56521327310569,"z":55.29454369528776},0,0,0,0,0,0,0,{"x":1379.6224011501095,"y":58.765798853727645,"z":-98.99137321099607},0,0,0,0,0,0,0,0,0],[0,0,0,0,{"x":-317.4163208266366,"y":57.51581840616975,"z":121.92390797432368},0,0,0,0,0,0,0,{"x":1368.791583158415,"y":52.35340195908617,"z":-50.655307818473375},0,0,0,0,0,0,0,0,0],[0,0,0,0,{"x":-17.0818526348653,"y":31.19140625000003,"z":83.45960951802829},0,0,0,0,0,0,0,{"x":1468.0913080124874,"y":47.339529359906976,"z":-41.674911305647925},0,0,0,0,0,0,0,0,0],[0,0,{"x":-758.791167802309,"y":13.531916558318247,"z":191.45137879774654},{"x":-413.2318596429638,"y":24.64124499280024,"z":203.54990766875298},{"x":-8.953175113713087,"y":24.64124633973416,"z":176.73630058960433},{"x":250.1373972739441,"y":24.641247262610715,"z":160.7271477348982},{"x":494.66318762302853,"y":24.64125011310945,"z":141.54698183256195},{"x":651.688003385274,"y":32.115764938981584,"z":82.71897131788498},{"x":836.4076878840283,"y":32.11576277867019,"z":59.86891958969119},{"x":994.9649386461929,"y":32.11576790650638,"z":24.531244378692975},{"x":1072.5011651993482,"y":32.11577159014091,"z":12.911349575014526},{"x":1290.4111678415607,"y":32.338820728291054,"z":11.585963743438526},{"x":1530.907550516189,"y":42.893409729003956,"z":-16.11970677227032},0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]]'
);
var arr3res = JSON.parse(
	'[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,1,0,0,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0],[0,1,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0],[0,1,0,0,1,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0],[0,1,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0],[0,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0],[0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0],[0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0],[0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0],[0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0],[0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0],[0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0],[0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0],[0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0],[0,0,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]]'
);
var graph = new Graph(arr3res, {
	diagonal: true
});
var xianlutexture = new THREE.Texture();
var lastID;

function creatLu(pos1, pos2) {
	var loader = new THREE.TextureLoader();
	loader.load("static/img/arrow.jpg", function(texture) {
		xianlutexture = texture;
		xianlutexture.wrapS = THREE.RepeatWrapping;
		xianlutexture.wrapT = THREE.RepeatWrapping;
		var material = new THREE.MeshBasicMaterial({
			map: xianlutexture
		});
		var start = graph.grid[pos1.i][pos1.j];
		var end = graph.grid[pos2.i][pos2.j];
		var results = astar.search(graph, start, end);
		var lujingPointArr = [];
		for (var i = 0; i < results.length; i += 1) {
			lujingPointArr.push(arr2res[results[i].x][results[i].y])
		}
		lujingPointArr.unshift(pos1.pos);
		lujingPointArr.push(pos2.pos);
		var aarrr = [];
		for (var i in lujingPointArr) {
			aarrr.push(new THREE.Vector3(lujingPointArr[i].x, lujingPointArr[i].y, lujingPointArr[i].z))
		}
		var curve = new THREE.CatmullRomCurve3(aarrr);
		var geometry = new THREE.TubeBufferGeometry(curve, 64, 8, 8);
		var mesh = new THREE.Mesh(geometry, material);
		mesh.position.y += 8;
		scene.add(mesh);
		lastID = mesh.id
	})
}

function daohang() {
	scene.remove(scene.getObjectById(lastID));
	var start = document.getElementById("start");
	var end = document.getElementById("end");
	var posA = new THREE.Vector3(Zuobiao[start.selectedIndex].x, Zuobiao[start.selectedIndex].y + 10, Zuobiao[start.selectedIndex].z);
	var posB = new THREE.Vector3(Zuobiao[end.selectedIndex].x, Zuobiao[end.selectedIndex].y + 10, Zuobiao[end.selectedIndex].z);
	var pos1 = zuijingdian(posA, arr1res);
	var pos2 = zuijingdian(posB, arr1res);
	lastID = creatLu(pos1, pos2)
}
document.getElementById("button").addEventListener("click", daohang);
var derc = document.getElementById("drec");

function render() {
	renderer.render(scene, camera);
	requestAnimationFrame(render);
	xianlutexture.offset.x -= 0.006;
	for (var i in sArry) {
		var s = sArry[i].position.distanceTo(camera.position);
		sArry[i].scale.set(s * xishu, s * xishu / 8, 1)
	}
	zhibeizhen(derc)
}
render();
var controls = new THREE.OrbitControls(camera, document.getElementsByTagName('canvas')[0]);
controls.maxPolarAngle = Math.PI / 2 - 0.1;
controls.maxDistance = 5000;
controls.minDistance = 800;
var jianjie = document.getElementById('jianjie');
var title = document.getElementById('title');
var neirong = document.getElementById('neirong');
var raycaster = new THREE.Raycaster();
var img = document.getElementById("img");
var mouse = new THREE.Vector2();

function onMouseMove() {
	var event1 = event;;
	switch (event.type) {
		case 'touchstart':
			event1 = event.touches[0];
			break
	}
	mouse.x = (event1.clientX / window.innerWidth) * 2 - 1;
	mouse.y = -(event1.clientY / window.innerHeight) * 2 + 1;
	raycaster.setFromCamera(mouse, camera);
	var intersects = raycaster.intersectObjects(scene.children);
	if (intersects[0].object.type == "Sprite") {
		$('#jianjie').show();
// 		document.getElementsByTagName('canvas')[0].removeEventListener('mousedown', onMouseMove);
// 		document.getElementsByTagName('canvas')[0].removeEventListener('touchstart', onMouseMove);
		$.ajax({
			type: "POST",
			data: "id=" + intersects[0].object.id,
			async: true,
			url: "https://www.todreamspace.com/3d/public/index.php/jiekouluyou",
			success: function(data) {
				var res = JSON.parse(data);
				if(res.title){
					title.innerHTML = res.title;
					neirong.innerHTML = res.neirong;
					img.src = res.imgUrl;
				}
			}
		})
	}
}
// document.getElementById("shut").addEventListener("touchstart", function() {
// 	// jianjie.style.display = 'none';
// 	setTimeout(function() {
// 		document.getElementsByTagName('canvas')[0].addEventListener('mousedown', onMouseMove);
// 		document.getElementsByTagName('canvas')[0].addEventListener('touchstart', onMouseMove)
// 	}, 500)
// });

$('canvas').on('touchstart',onMouseMove);

$('#logo').on("touchstart", function() {
	$('#jianjie').fadeToggle(300);
	$.ajax({
		type: "POST",
		data: "id=0",
		async: true,
		url: "https://www.todreamspace.com/3d/public/index.php/jiekouluyou",
		success: function(data) {
			var res = JSON.parse(data);
			title.innerHTML = res.title;
			neirong.innerHTML = res.neirong;
			img.src = res.imgUrl
		}
	})
});

function zhibeizhen(derc) {
	var vectorCam = new THREE.Vector2(camera.position.x, camera.position.z);
	var deg = (180 / Math.PI * vectorCam.angle() - 90) * -1;
	derc.style.transform = "rotate(" + deg + "deg)"
}

window.addEventListener('resize',function(){
	reSize();
	render();
});


function zuijingdian(point, arr) {
	var dis = 10000;
	var index;
	for (var i = 0; i < arr.length; i += 1) {
		if (dis > point.distanceTo(arr[i].pos)) {
			dis = point.distanceTo(arr[i].pos);
			index = i
		}
	}
	return arr[index]
}



//重置浏览器
function  reSize(){
	renderer.setSize(window.innerWidth *3, window.innerHeight * 3);
	renderer.domElement.style.width = window.innerWidth + 'px';
	renderer.domElement.style.height = window.innerHeight + 'px';
}


// $('#logo').on("touchstart",function(){
//   $('#luxian').toggle();
// });

$('#title').on('touchstart',function(){
	$('#jianjie').hide();
})


$('#audioIco').on('touchstart',function(){
	var player=$('#voice')[0];
	console.log(player);
	if(player.paused){
		$('#audioIco1')[0].src='static/img/audio.png';
		player.play();
		console.log($('#audioIco1')[0]);
	}else{
		$('#audioIco1')[0].src='static/img/audio0.png'
		player.pause();
		console.log($('#audioIco')[0]);
	}
})